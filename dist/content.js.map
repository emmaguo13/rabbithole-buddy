{
  "version": 3,
  "sources": ["../src/content.ts"],
  "sourcesContent": ["// Minimal TS annotator content script\n\ntype Tool = \"none\" | \"draw\" | \"highlight\" | \"note\";\n\nlet currentTool: Tool = \"none\";\nlet drawing = false;\nlet ctx: CanvasRenderingContext2D | null = null;\nlet canvas: HTMLCanvasElement | null = null;\n\nfunction init() {\n  if (document.getElementById(\"annotator-overlay\")) return;\n\n  const overlay = document.createElement(\"div\");\n  overlay.id = \"annotator-overlay\";\n  document.body.appendChild(overlay);\n\n  canvas = document.createElement(\"canvas\");\n  canvas.id = \"annotator-canvas\";\n  overlay.appendChild(canvas);\n\n  ctx = canvas.getContext(\"2d\");\n  resizeCanvas();\n  window.addEventListener(\"resize\", resizeCanvas);\n\n  createToolbar();\n  attachCanvasEvents();\n  attachDocumentEvents();\n}\n\nfunction resizeCanvas() {\n  if (!canvas) return;\n  canvas.width = window.innerWidth;\n  canvas.height = window.innerHeight;\n}\n\nfunction createToolbar() {\n  const toolbar = document.createElement(\"div\");\n  toolbar.id = \"annotator-toolbar\";\n  toolbar.innerHTML = `\n    <button data-tool=\"draw\">\u270F\uFE0F</button>\n    <button data-tool=\"highlight\">\uD83D\uDD8D</button>\n    <button data-tool=\"note\">\uD83D\uDCDD</button>\n    <button data-tool=\"none\">\uD83D\uDE48</button>\n  `;\n  document.body.appendChild(toolbar);\n\n  toolbar.querySelectorAll(\"button\").forEach((btn) => {\n    btn.addEventListener(\"click\", () => {\n      const tool = btn.getAttribute(\"data-tool\") as Tool;\n      setTool(tool);\n    });\n  });\n}\n\nfunction setTool(tool: Tool) {\n  currentTool = tool;\n  const toolbar = document.getElementById(\"annotator-toolbar\");\n  toolbar?.querySelectorAll(\"button\").forEach((b) => {\n    b.classList.toggle(\"active\", b.getAttribute(\"data-tool\") === tool);\n  });\n  if (canvas) canvas.style.pointerEvents = tool === \"draw\" ? \"auto\" : \"none\";\n}\n\nfunction attachCanvasEvents() {\n  if (!canvas || !ctx) return;\n\n  canvas.addEventListener(\"mousedown\", (e) => {\n    if (currentTool !== \"draw\") return;\n    drawing = true;\n    ctx.beginPath();\n    ctx.moveTo(e.clientX, e.clientY);\n  });\n\n  canvas.addEventListener(\"mousemove\", (e) => {\n    if (!drawing || currentTool !== \"draw\") return;\n    ctx.lineTo(e.clientX, e.clientY);\n    ctx.strokeStyle = \"yellow\";\n    ctx.lineWidth = 4;\n    ctx.lineCap = \"round\";\n    ctx.stroke();\n  });\n\n  window.addEventListener(\"mouseup\", () => (drawing = false));\n}\n\nfunction attachDocumentEvents() {\n  document.addEventListener(\"mouseup\", () => {\n    if (currentTool === \"highlight\") highlightSelection();\n  });\n\n  document.addEventListener(\"dblclick\", (e) => {\n    if (currentTool === \"note\") addNoteAt(e.clientX, e.clientY);\n  });\n}\n\nfunction highlightSelection() {\n  const sel = window.getSelection();\n  if (!sel || sel.rangeCount === 0) return;\n\n  const range = sel.getRangeAt(0);\n  if (range.collapsed) return;\n\n  const mark = document.createElement(\"mark\");\n  mark.style.backgroundColor = \"yellow\";\n  try {\n    range.surroundContents(mark);\n  } catch {}\n  sel.removeAllRanges();\n}\n\nfunction addNoteAt(x: number, y: number) {\n  const note = document.createElement(\"div\");\n  note.className = \"annotator-note\";\n  note.style.left = x + \"px\";\n  note.style.top = y + \"px\";\n\n  const header = document.createElement(\"div\");\n  header.className = \"annotator-note-header\";\n  header.textContent = \"Note\";\n\n  const body = document.createElement(\"div\");\n  body.className = \"annotator-note-body\";\n  body.contentEditable = \"true\";\n  body.textContent = \"Edit me\";\n\n  note.appendChild(header);\n  note.appendChild(body);\n  document.body.appendChild(note);\n}\n\nif (document.readyState === \"loading\") {\n  document.addEventListener(\"DOMContentLoaded\", init);\n} else {\n  init();\n}\n"],
  "mappings": "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",
  "names": []
}

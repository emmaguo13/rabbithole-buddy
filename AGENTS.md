# Repository Guidelines

## Project Structure & Module Organization
- `src/extension.ts`: Entry content script that builds the overlay, toolbar, and wires tools together.
- `src/drawing.ts`: Canvas draw logic; listens for pointer events and renders strokes.
- `src/notes.ts`: Note and highlight helpers; reacts to selection and double-clicks.
- `src/styles.css`: Visuals for overlay, toolbar, and notes; bundled alongside JS.
- `manifest.json`: MV3 manifest pointing to the bundled content script and CSS.
- `dist/`: esbuild output; regenerated by scripts, never edited directly.
- TypeScript runs in `strict` mode via `tsconfig.json`.

## Build, Test, and Development Commands
- Install once: `npm install`.
- Build bundle: `npm run build` (esbuild -> `dist/content.js`, copies `manifest.json` and `styles.css`).
- Dev loop: `npm run watch` (auto-rebundle on save).
- Load locally: Chrome → Extensions → Load unpacked → select `dist/`.

## Coding Style & Naming Conventions
- TypeScript-first; keep explicit types on exported helpers and DOM handlers.
- Two-space indentation; keep lines readable (<100 chars when possible).
- Prefer small, single-purpose helpers over large event handlers; avoid mutating shared state across modules.
- DOM ids/classes for annotator UI use the `annotator-` prefix to avoid host-page collisions.
- Run `npm run build` before sharing changes to ensure the bundle compiles.

## Testing Guidelines
- No automated tests yet; rely on manual smoke tests in Chrome.
- Verify: drawing start/stop, stroke color/width, highlighting selections, adding notes, window resize, and tool toggling.
- If you add tests, colocate them (e.g., `src/extension.spec.ts`) and document how to run them.

## Commit & Pull Request Guidelines
- Commits: concise imperative mood (e.g., “Add stroke throttling”); group related edits.
- PRs include: summary of behavior changes, screenshots/GIFs for UI, and manual test notes.
- Keep generated `dist/` diffs minimal; reviewers focus on `src/` and configs. Note which build command you ran.

## Security & Configuration Tips
- Content script matches `<all_urls>`; avoid network calls or persisting sensitive data.
- Keep overlay isolated with high `z-index` and scoped selectors; do not override host page styles unless necessary.
